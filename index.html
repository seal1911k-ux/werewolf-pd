<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Werewolf PD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">

    <style>
        body { background-color: #1a1d20; color: #dee2e6; font-family: 'Kanit', sans-serif; }
        h1 { color: #dc3545; text-transform: uppercase; text-shadow: 2px 2px 4px #000; letter-spacing: 2px; }
        .card { background-color: #2c3034; border: 1px solid #495057; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .card-header { font-weight: bold; color: #ffc107; text-transform: uppercase; letter-spacing: 1px; }

        .role-action-box { display: none; margin-bottom: 10px; padding: 10px; border-radius: 5px; background: rgba(0,0,0,0.2); border-left: 4px solid #777; }
        .role-action-box.active { display: block; animation: fadeIn 0.5s; }

        .timer-display { font-family: 'Orbitron', sans-serif; font-size: 3.5rem; color: #00ff00; text-shadow: 0 0 10px rgba(0,255,0,0.5); background: #000; padding: 15px; border-radius: 10px; border: 2px solid #333; margin: 10px 0; }
        .timer-vote { color: #ff4757; text-shadow: 0 0 10px rgba(255, 71, 87, 0.5); }

        #hunter-revenge-section, #mad-bomber-section { display: none; background-color: #7f1d1d; border: 2px solid #ef4444; padding: 15px; border-radius: 10px; margin-bottom: 20px; animation: bounceIn 0.5s; }
        #wolf-rage-box { display: none; margin-top: 5px; padding: 5px; background-color: #4b0d0d; border-left: 3px solid #ff0000; font-size: 0.85rem;}
        #disease-alert { display: none; background: #d63384; color: white; padding: 5px; border-radius: 5px; margin-bottom: 5px; font-size: 0.9rem; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes bounceIn { 0% { transform: scale(0.8); opacity: 0; } 60% { transform: scale(1.05); opacity: 1; } 100% { transform: scale(1); } }

        .game-over-alert { font-size: 1.5rem; font-weight: bold; text-align: center; padding: 30px; margin-top: 20px; border-radius: 15px; display: none; box-shadow: 0 0 20px rgba(0,0,0,0.7); border: 2px solid #fff; }
        .st-alive { color: #2ecc71; font-weight: bold; }
        .st-dead { color: #e74c3c; font-weight: bold; }
        .dead-row { background-color: #3e2a2a !important; color: #888; text-decoration: line-through; }
        .log-box { background: #000; color: #00ff00; font-family: 'Consolas', monospace; padding: 15px; height: 350px; overflow-y: auto; border: 1px solid #555; border-radius: 5px; font-size: 0.9rem; }
    </style>
</head>
<body class="p-3">

    <div class="container pb-5">
        <h1 class="text-center mb-2">üê∫ Werewolf PD</h1>

        <div class="text-center mb-4">
            <button id="btn-mute" class="btn btn-outline-warning btn-sm" onclick="toggleSound()">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡∏π‡πà</button>
        </div>

        <div class="modal fade" id="roleInfoModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered"><div class="modal-content bg-dark text-white"><div class="modal-header"><h5 class="modal-title" id="modal-role-name"></h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div><div class="modal-body"><p id="modal-role-description"></p><p class="small text-muted">‡∏ó‡∏µ‡∏°: <span id="modal-role-team"></span></p></div></div></div>
        </div>

        <div class="modal fade" id="drunkPoolModal" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content bg-dark text-white border-warning">
                    <div class="modal-header bg-warning text-dark"><h5 class="modal-title fw-bold">üç∫ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤: ‡∏Å‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤</h5></div>
                    <div class="modal-body">
                        <div class="alert alert-secondary text-dark small">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏™‡πà‡∏Å‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á (‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 3 ‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ 1 ‡πÉ‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≠‡∏á‡∏ô‡∏µ‡πâ)</div>
                        <div id="drunk-pool-selection" class="row g-2"></div>
                    </div>
                    <div class="modal-footer border-secondary"><button type="button" class="btn btn-warning fw-bold w-100" onclick="saveDrunkPool()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å & ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button></div>
                </div>
            </div>
        </div>

        <div class="row" id="setup-section">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div>
                    <div class="card-body">
                        <div class="row g-2 align-items-center mb-3">
                            <div class="col-md-4"><input type="text" id="pName" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô..." onkeypress="handleEnter(event)"></div>
                            <div class="col-md-4"><select id="pRole" class="form-select"></select></div>
                            <div class="col-md-2"><button class="btn btn-outline-info w-100" onclick="showRoleInfo()">‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button></div>
                            <div class="col-md-2"><button class="btn btn-success w-100" onclick="addPlayer()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°</button></div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-dark table-hover align-middle">
                                <thead><tr><th>‡∏ä‡∏∑‡πà‡∏≠ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</th><th>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th><th>‡∏•‡∏ö</th></tr></thead>
                                <tbody id="setup-table-body"></tbody>
                            </table>
                        </div>
                        <button class="btn btn-warning w-100 mt-2 fw-bold py-2" onclick="checkDrunkAndStart()">‚úÖ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>

                        <button class="btn btn-outline-secondary w-100 mt-2 btn-sm" onclick="loadLastGame()">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏£‡∏•‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß (‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡πà‡∏≠)</button>

                    </div>
                </div>
            </div>
        </div>

        <div id="winner-banner" class="game-over-alert"></div>
        <div id="hunter-revenge-section"><h4 class="text-white">üî´ ‡∏ô‡∏≤‡∏¢‡∏û‡∏£‡∏≤‡∏ô‡∏ï‡∏≤‡∏¢!</h4><div class="input-group"><select id="hunter-target" class="form-select bg-dark text-white"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠...</option></select><button class="btn btn-light fw-bold" onclick="hunterShoot()">üí• ‡∏¢‡∏¥‡∏á!</button></div></div>
        <div id="mad-bomber-section"><h4 class="text-white">üí£ ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!</h4><div class="input-group mb-2"><span class="input-group-text">L</span><select id="bomber-L" class="form-select bg-dark text-white"><option value="">...</option></select></div><div class="input-group mb-2"><span class="input-group-text">R</span><select id="bomber-R" class="form-select bg-dark text-white"><option value="">...</option></select></div><button class="btn btn-light fw-bold w-100" onclick="bomberExplode()">üí• ‡∏ö‡∏π‡πâ‡∏°!</button></div>

        <div class="row d-none" id="game-section">
            <div class="col-lg-6 mb-3">
                <div class="card border-info mb-3" id="day-timer-section" style="display:none;">
                    <div class="card-header text-info text-center" id="phase-title">‚òÄÔ∏è ‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1</div>
                    <div class="card-body text-center">
                        <div id="timer-setup"><label class="mb-2 small">‡πÄ‡∏ß‡∏•‡∏≤‡∏Ñ‡∏∏‡∏¢:</label><div class="input-group justify-content-center mb-3" style="max-width:300px;margin:0 auto;"><input type="number" id="day-min" class="form-control text-center" value="3"><span class="input-group-text">:</span><input type="number" id="day-sec" class="form-control text-center" value="0"><button class="btn btn-primary" onclick="saveAndStartTimer()">‡πÄ‡∏£‡∏¥‡πà‡∏° ‚ñ∂Ô∏è</button></div></div>
                        <div id="timer-quick-start" style="display:none;" class="mb-3"><button class="btn btn-lg btn-success w-75 mb-2 shadow" onclick="quickStartTimer()">‚ñ∂Ô∏è ‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ (<span id="quick-time-label">00:00</span>)</button><br><button class="btn btn-sm btn-outline-secondary" onclick="showTimerEdit()">üõ†Ô∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button></div>
                        <div id="timer-display" class="timer-display">00:00</div>
                        <div id="timer-controls" style="display:none;"><button class="btn btn-warning btn-sm" onclick="pauseTimer()">‡∏´‡∏¢‡∏∏‡∏î/‡∏ï‡πà‡∏≠</button><button class="btn btn-danger btn-sm" onclick="skipToVote()">‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÇ‡∏´‡∏ß‡∏ï ‚è≠Ô∏è</button></div>
                    </div>
                </div>

                <div class="card border-warning mb-3" id="night-control-section" style="display:none;">
                    <div class="card-header text-warning">üåô ‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏µ‡πà <span id="night-count">1</span></div>
                    <div class="card-body">
                        <div id="box-cupid" class="role-action-box" style="border-color:#e84393;"><span class="role-title text-white">üíò ‡∏Å‡∏≤‡∏°‡πÄ‡∏ó‡∏û</span><div class="input-group"><select id="cupid-1" class="form-select bg-dark text-white"><option value="">1</option></select><select id="cupid-2" class="form-select bg-dark text-white"><option value="">2</option></select></div></div>
                        <div id="box-spellcaster" class="role-action-box"><span class="role-title text-white">ü§ê ‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó</span><select id="spell-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-oldhag" class="role-action-box"><span class="role-title text-white">üëµ ‡πÅ‡∏°‡πà‡∏´‡∏°‡∏≠</span><select id="hag-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-guard" class="role-action-box"><span class="role-title text-white">üõ°Ô∏è ‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î (‡∏Å‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)</span><select id="guard-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-priest" class="role-action-box"><span class="role-title text-white">‚úùÔ∏è ‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä</span><select id="priest-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-wolf" class="role-action-box active" style="border-color:#d63031;"><span class="role-title text-white">üê∫ ‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (‡∏Ü‡πà‡∏≤‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤)</span><div id="disease-alert">ü¶† ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠! ‡∏á‡∏î‡∏Ü‡πà‡∏≤</div><select id="wolf-target" class="form-select bg-dark text-white border-danger"><option value="">- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏¢ -</option></select><div id="wolf-rage-box"><label class="text-white small">üî• ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ñ‡πâ‡∏ô (‡∏Ü‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°):</label><select id="wolf-target-2" class="form-select bg-dark text-white"><option value="">-</option></select></div></div>
                        <div id="box-vampire" class="role-action-box" style="border-color:#ff7675;"><span class="role-title text-white">üßõ‚Äç‚ôÇÔ∏è ‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå (‡∏Å‡∏±‡∏î=‡∏ï‡∏≤‡∏¢‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏ß‡∏ï)</span><select id="vampire-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-witch" class="role-action-box" style="border-color:#f1c40f;"><span class="role-title text-white">üß™ ‡πÅ‡∏°‡πà‡∏°‡∏î</span><div class="d-flex gap-2"><select id="witch-save" class="form-select bg-dark text-white"><option value="">‡∏¢‡∏≤‡∏ä‡πà‡∏ß‡∏¢: -</option></select><select id="witch-kill" class="form-select bg-dark text-white"><option value="">‡∏¢‡∏≤‡∏û‡∏¥‡∏©: -</option></select></div></div>
                        <div id="box-huntress" class="role-action-box"><span class="role-title text-white">üèπ ‡∏û‡∏£‡∏≤‡∏ô‡∏´‡∏ç‡∏¥‡∏á</span><select id="huntress-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-revealer" class="role-action-box"><span class="role-title text-white">üî¶ ‡∏ú‡∏π‡πâ‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span><select id="revealer-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-cult" class="role-action-box"><span class="role-title text-white">üõê ‡πÄ‡∏à‡πâ‡∏≤‡∏•‡∏±‡∏ó‡∏ò‡∏¥</span><select id="cult-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-seer" class="role-action-box"><span class="role-title text-white">üîÆ ‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå</span><select id="seer-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-mystic" class="role-action-box"><span class="role-title text-white">üëÅÔ∏è‚Äçüó®Ô∏è ‡πÄ‡∏ó‡∏û‡∏ú‡∏π‡πâ‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á</span><select id="mystic-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-auraseer" class="role-action-box"><span class="role-title text-white">‚ú® ‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå (‡πÄ‡∏ä‡πá‡∏Ñ‡πÇ‡∏£‡∏•‡∏û‡∏¥‡πÄ‡∏®‡∏©)</span><select id="aura-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-sorcerer" class="role-action-box"><span class="role-title text-white">üëÅÔ∏è ‡∏ô‡∏≤‡∏á‡∏õ‡∏µ‡∏®‡∏≤‡∏à</span><select id="sorcerer-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-pi" class="role-action-box"><span class="role-title text-white">üïµÔ∏è‚Äç‚ôÇÔ∏è ‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö</span><select id="pi-target" class="form-select bg-dark text-white"><option value="">-</option></select></div>
                        <div id="box-mentalist" class="role-action-box"><span class="role-title text-white">üß† ‡∏ô‡∏±‡∏Å‡∏™‡∏∞‡∏Å‡∏î‡∏à‡∏¥‡∏ï</span><div class="input-group"><select id="mental-1" class="form-select bg-dark text-white"><option value="">1</option></select><select id="mental-2" class="form-select bg-dark text-white"><option value="">2</option></select></div></div>
                        <button id="btn-night" class="btn btn-danger w-100 mt-3 shadow" onclick="processNight()">‚ö° ‡∏à‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏µ‡πâ</button>
                    </div>
                </div>

                <div class="card border-info" id="vote-control-section" style="display:none;">
                    <div class="card-header text-info">üó≥Ô∏è ‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÇ‡∏´‡∏ß‡∏ï (‡πÇ‡∏ö‡∏™‡∏ñ‡πå)</div>
                    <div class="card-body">
                        <div id="vote-select-phase">
                            <label class="mb-2 text-white small">‡πÉ‡∏Ñ‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÇ‡∏´‡∏ß‡∏ï‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î?</label>
                            <div class="input-group mb-2">
                                <select id="vote-target" class="form-select bg-dark text-white border-secondary"><option value="">- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏ß‡∏ï -</option></select>
                                <button class="btn btn-warning fw-bold" onclick="startDefense()">‚öñÔ∏è ‡πÄ‡∏ä‡∏¥‡∏ç‡∏Ç‡∏∂‡πâ‡∏ô‡∏®‡∏≤‡∏•</button>
                            </div>
                            <button class="btn btn-secondary w-100 btn-sm" onclick="endDayGoNight()">üåô ‡∏à‡∏ö‡∏ß‡∏±‡∏ô (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏¢)</button>
                        </div>
                        <div id="vote-defense-phase" style="display:none;" class="text-center">
                            <h4 class="text-danger">‚öñÔ∏è ‡∏®‡∏≤‡∏•‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ñ‡∏î‡∏µ</h4>
                            <h2 class="text-warning my-3" id="defendant-name">‡∏à‡∏≥‡πÄ‡∏•‡∏¢: ???</h2>
                            <div class="alert alert-secondary p-2 mb-3">‚è≥ ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏Å‡πâ‡∏ï‡∏±‡∏ß: <span id="defense-timer" class="fw-bold fs-4">30</span> ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
                            <div class="row g-2">
                                <div class="col-6"><button class="btn btn-outline-success w-100 py-3" onclick="finalizeVerdict(false)">üïäÔ∏è ‡∏£‡∏≠‡∏î (Innocent)</button></div>
                                <div class="col-6"><button class="btn btn-danger w-100 py-3" onclick="finalizeVerdict(true)">üëé ‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£ (Guilty)</button></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="card mb-3"><div class="card-header">üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div><div class="card-body p-0"><table class="table table-dark table-striped mb-0 table-sm"><thead><tr><th>‡∏ä‡∏∑‡πà‡∏≠ (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ)</th><th>‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó</th><th>‡∏•‡∏ö</th></tr></thead><tbody id="status-table-body"></tbody></table></div></div>
                <div class="card"><div class="card-header">üìú Log</div><div class="card-body p-0"><div id="game-log" class="log-box"></div></div></div>
                <div class="text-center mt-3"><button onclick="if(confirm('‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï?')) location.reload()" class="btn btn-outline-secondary btn-sm">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const roleDB = [
            { group: "‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô", roles: [{name:"‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô (Villager)",team:"villager"},{name:"‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (Seer)",team:"villager"},{name:"‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó (Spellcaster)",team:"villager"},{name:"‡∏Å‡∏≤‡∏°‡πÄ‡∏ó‡∏û (Cupid)",team:"villager"},{name:"‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î (Bodyguard)",team:"villager"},{name:"‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå (Aura Seer)",team:"villager"},{name:"‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤ (Drunk)",team:"villager"},{name:"‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡∏≤‡∏¢ (Prince)",team:"villager"},{name:"‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä (Priest)",team:"villager"},{name:"‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö (P.I.)",team:"villager"},{name:"‡∏ï‡∏±‡∏ß‡∏õ‡πà‡∏ß‡∏ô (Troublemaker)",team:"villager"},{name:"‡πÅ‡∏°‡πà‡∏°‡∏î (Witch)",team:"villager"},{name:"‡πÅ‡∏°‡πà‡∏´‡∏°‡∏≠ (Old Hag)",team:"villager"},{name:"‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (Apprentice Seer)",team:"villager"},{name:"‡∏ô‡∏≤‡∏¢‡∏Å‡πÄ‡∏ó‡∏®‡∏°‡∏ô‡∏ï‡∏£‡∏µ (Mayor)",team:"villager"},{name:"‡∏ô‡∏≤‡∏¢‡∏û‡∏£‡∏≤‡∏ô (Hunter)",team:"villager"},{name:"‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ (Disease)",team:"villager"},{name:"‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏Å‡∏™‡∏±‡∏ô‡∏ï‡∏¥ (Pacifist)",team:"villager"},{name:"‡∏û‡∏£‡∏≤‡∏¢‡∏Å‡∏£‡∏∞‡∏ã‡∏¥‡∏ö (Ghost)",team:"villager"},{name:"‡∏†‡∏£‡∏≤‡∏î‡∏£‡πÅ‡∏´‡πà‡∏á‡πÄ‡∏°‡∏™‡∏±‡∏ô (Mason)",team:"villager"},{name:"‡∏†‡∏π‡∏ï‡∏à‡∏≥‡πÅ‡∏•‡∏á (Doppelganger)",team:"villager"},{name:"‡∏•‡∏π‡∏Å‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Lycan)",team:"villager"},{name:"‡∏´‡∏ô‡∏∏‡πà‡∏°‡∏ñ‡∏∂‡∏Å (Tough Guy)",team:"villager"},{name:"‡πÑ‡∏≠‡πâ‡∏ó‡∏∂‡πà‡∏° (Villager Idiot)",team:"villager"},{name:"‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏û‡∏•‡∏µ‡∏ä‡∏µ‡∏û (Mad Bomber)",team:"villager"},{name:"‡πÄ‡∏ó‡∏û‡∏ú‡∏π‡πâ‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (Mystic Seer)",team:"villager"},{name:"‡∏û‡∏£‡∏≤‡∏ô‡∏´‡∏ç‡∏¥‡∏á (Huntress)",team:"villager"},{name:"‡∏ô‡∏±‡∏Å‡∏™‡∏∞‡∏Å‡∏î‡∏à‡∏¥‡∏ï (Mentalist)",team:"villager"},{name:"‡∏ú‡∏π‡πâ‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (Revealer)",team:"villager"}] },
            { group: "‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤", roles: [{name:"‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Werewolf)",team:"wolf"},{name:"‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏î‡∏≤‡∏¢ (Lone Wolf)",team:"wolf"},{name:"‡∏•‡∏π‡∏Å‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Wolf Cub)",team:"wolf"},{name:"‡∏™‡∏°‡∏∏‡∏ô‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ (Minion)",team:"wolf"},{name:"‡∏ô‡∏≤‡∏á‡∏õ‡∏µ‡∏®‡∏≤‡∏à (Sorcerer)",team:"wolf"},{name:"‡∏≠‡∏±‡∏ô‡∏ò‡∏û‡∏≤‡∏• (Hoodlum)",team:"wolf"},{name:"‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏≤‡∏õ (Cursed)",team:"villager"},{name:"‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏à‡πà‡∏≤‡∏ù‡∏π‡∏á (Alpha Wolf)",team:"wolf"}] },
            { group: "‡∏≠‡∏∑‡πà‡∏ô‡πÜ", roles: [{name:"‡∏¢‡∏≤‡∏à‡∏Å (Tanner)",team:"solo"},{name:"‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå (Vampire)",team:"vampire"},{name:"‡πÄ‡∏à‡πâ‡∏≤‡∏•‡∏±‡∏ó‡∏ò‡∏¥ (Cult Leader)",team:"cult"}, {name:"‡∏Ü‡∏≤‡∏ï‡∏Å‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (Serial Killer)", team:"solo"}] }
        ];

        const roleDescriptions = {
            "‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô (Villager)": { desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏©", team: "Villager" },
            "‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (Seer)": { desc: "‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏•‡∏ß (Good/Bad)", team: "Villager" },
            "‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó (Spellcaster)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠ '‡πÉ‡∏ö‡πâ' ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏±‡πâ‡∏ô", team: "Villager" },
            "‡∏Å‡∏≤‡∏°‡πÄ‡∏ó‡∏û (Cupid)": { desc: "‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏ô‡πÅ‡∏£‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å 2 ‡∏Ñ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏ô‡πÉ‡∏î‡∏Ñ‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ï‡∏≤‡∏¢ ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏ô‡∏à‡∏∞‡∏ï‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ", team: "Villager" },
            "‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î (Bodyguard)": { desc: "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏Ü‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏±‡πâ‡∏ô (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)", team: "Villager" },
            "‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå (Aura Seer)": { desc: "‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡πÄ‡∏•‡∏ß ‡πÅ‡∏ï‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå", team: "Villager" },
            "‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤ (Drunk)": { desc: "‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 3 ‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡∏Å‡∏≠‡∏á‡∏ó‡∏µ‡πà Mod ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ß‡πâ", team: "Villager (‡∏£‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô)" },
            "‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡∏≤‡∏¢ (Prince)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£ ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)", team: "Villager" },
            "‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä (Priest)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏¢‡∏≤‡∏û‡∏¥‡∏©)", team: "Villager" },
            "‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö (P.I.)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏≠‡∏á‡∏Ñ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏≠‡∏á‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏°‡∏µ‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà", team: "Villager" },
            "‡∏ï‡∏±‡∏ß‡∏õ‡πà‡∏ß‡∏ô (Troublemaker)": { desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÅ‡∏ï‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏ö‡∏™‡∏ô", team: "Villager" },
            "‡πÅ‡∏°‡πà‡∏°‡∏î (Witch)": { desc: "‡∏°‡∏µ 2 ‡∏¢‡∏≤: ‡∏¢‡∏≤‡∏ä‡πà‡∏ß‡∏¢ (Save) ‡πÅ‡∏•‡∏∞‡∏¢‡∏≤‡∏û‡∏¥‡∏© (Kill) ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÄ‡∏Å‡∏°", team: "Villager" },
            "‡πÅ‡∏°‡πà‡∏´‡∏°‡∏≠ (Old Hag)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠ '‡πÑ‡∏•‡πà‡∏≠‡∏≠‡∏Å' ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ô‡∏±‡πâ‡∏ô", team: "Villager" },
            "‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå (Apprentice Seer)": { desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÅ‡∏ï‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÉ‡∏Ñ‡∏£‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå", team: "Villager" },
            "‡∏ô‡∏≤‡∏¢‡∏Å‡πÄ‡∏ó‡∏®‡∏°‡∏ô‡∏ï‡∏£‡∏µ (Mayor)": { desc: "‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ä‡∏µ‡πâ‡∏Ç‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô (Mod ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô)", team: "Villager" },
            "‡∏ô‡∏≤‡∏¢‡∏û‡∏£‡∏≤‡∏ô (Hunter)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏î‡∏Å‡πá‡∏ï‡∏≤‡∏° ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ 1 ‡∏Ñ‡∏ô", team: "Villager" },
            "‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠ (Disease)": { desc: "‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏Ü‡πà‡∏≤ ‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏à‡∏∞‡∏á‡∏î‡∏Ü‡πà‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏∑‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ", team: "Villager" },
            "‡∏´‡∏ô‡∏∏‡πà‡∏°‡∏ñ‡∏∂‡∏Å (Tough Guy)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ï‡∏≤‡∏¢‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡∏ï‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏£‡∏∏‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô", team: "Villager" },
            "‡πÑ‡∏≠‡πâ‡∏ó‡∏∂‡πà‡∏° (Villager Idiot)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£ ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÅ‡∏û‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ)", team: "Villager (Idiot)" },
            "‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏û‡∏•‡∏µ‡∏ä‡∏µ‡∏û (Mad Bomber)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡∏Ü‡πà‡∏≤‡∏ï‡∏≤‡∏¢ ‡∏à‡∏∞‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏ß‡∏≤‡∏Ç‡∏≠‡∏á‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏ï‡∏≤‡∏¢‡∏ï‡∏≤‡∏°‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢", team: "Villager" },
            "‡∏û‡∏£‡∏≤‡∏ô‡∏´‡∏ç‡∏¥‡∏á (Huntress)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ü‡πà‡∏≤", team: "Villager" },
            "‡πÄ‡∏ó‡∏û‡∏ú‡∏π‡πâ‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á (Mystic Seer)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á", team: "Villager" },
            "‡∏ú‡∏π‡πâ‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (Revealer)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏≤‡∏¢ ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ ‡∏ï‡∏ô‡πÄ‡∏≠‡∏á‡∏à‡∏∞‡∏ï‡∏≤‡∏¢", team: "Villager" },
            "‡∏ô‡∏±‡∏Å‡∏™‡∏∞‡∏Å‡∏î‡∏à‡∏¥‡∏ï (Mentalist)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏™‡∏≠‡∏á‡∏Ñ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà", team: "Villager" },
            "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Werewolf)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ü‡πà‡∏≤ ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡∏à‡∏∞‡∏Ü‡πà‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤", team: "Wolf" },
            "‡∏•‡∏π‡∏Å‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Wolf Cub)": { desc: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∑‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ü‡πà‡∏≤ 2 ‡∏Ñ‡∏ô", team: "Wolf" },
            "‡∏ô‡∏≤‡∏á‡∏õ‡∏µ‡∏®‡∏≤‡∏à (Sorcerer)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏≠‡∏á ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô '‡∏Ñ‡∏ô‡∏î‡∏µ' ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏≠‡∏á‡∏à‡∏∞‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô '‡∏Ñ‡∏ô‡πÄ‡∏•‡∏ß' ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ú‡∏•", team: "Wolf" },
            "‡∏ú‡∏π‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏≤‡∏õ (Cursed)": { desc: "‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏Ü‡πà‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡πÅ‡∏ó‡∏ô", team: "Villager (Curse)" },
            "‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå (Vampire)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Å‡∏±‡∏î‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡∏ï‡∏≤‡∏¢‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏ß‡∏ï (Vote Phase)", team: "Vampire" },
            "‡∏¢‡∏≤‡∏à‡∏Å (Tanner)": { desc: "‡∏ä‡∏ô‡∏∞‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏ß‡∏ï‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£", team: "Solo (Tanner)" },
            "‡∏Ü‡∏≤‡∏ï‡∏Å‡∏£‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á (Serial Killer)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ü‡πà‡∏≤ (‡∏ä‡∏ô‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)", team: "Solo (SK)" },
            "‡πÄ‡∏à‡πâ‡∏≤‡∏•‡∏±‡∏ó‡∏ò‡∏¥ (Cult Leader)": { desc: "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ù‡πà‡∏≤‡∏¢‡∏•‡∏±‡∏ó‡∏ò‡∏¥ (‡∏ä‡∏ô‡∏∞‡∏Ñ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)", team: "Cult" }
        };

        let players = [];
        let nightCount = 1;
        let dayCount = 1;
        let isGameOver = false;
        let wolfRageMode = false, wolfDisabled = false;
        let lastGuardedId = null;
        let delayedDeaths = [], pendingVampireVictims = [];
        let timerInterval = null, timeLeft = 0;
        let savedTime = { m: 3, s: 0 };
        let drunkRolePool = [];
        let currentDefendant = null;
        let audioCtx = null;
        let isMuted = false;

        window.onload = function() {
            const select = document.getElementById('pRole');
            roleDB.forEach(g => { let grp=document.createElement('optgroup'); grp.label=g.group; g.roles.forEach(r=>{let o=document.createElement('option');o.value=r.name;o.innerText=r.name;o.dataset.team=r.team;grp.appendChild(o)}); select.appendChild(grp); });
        };

        function handleEnter(e) { if(e.key === 'Enter') addPlayer(); }

        function showRoleInfo() {
            const r = document.getElementById('pRole').value;
            const info = roleDescriptions[r] || { desc: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", team: "-" };
            document.getElementById('modal-role-name').innerText = r;
            document.getElementById('modal-role-description').innerText = info.desc;
            document.getElementById('modal-role-team').innerText = info.team;
            new bootstrap.Modal(document.getElementById('roleInfoModal')).show();
        }

        function addPlayer() {
            const n=document.getElementById('pName'); const r=document.getElementById('pRole');
            if(!n.value.trim()) return;
            players.push({id:Date.now(), name:n.value.trim(), role:r.value, team:r.options[r.selectedIndex].dataset.team, isAlive:true, loverId:null});
            n.value=''; n.focus(); renderSetupTable();
        }

        function renderSetupTable(){
            document.getElementById('setup-table-body').innerHTML = players.map((p,i)=>`
                <tr>
                    <td><input type="text" class="form-control form-control-sm bg-dark text-white border-secondary" value="${p.name}" onchange="updatePlayerName(${i}, this.value)"></td>
                    <td>${p.role}</td>
                    <td><button class="btn btn-sm btn-outline-danger" onclick="removePlayer(${i})">X</button></td>
                </tr>`).join('');
        }

        function updatePlayerName(index, newName) { players[index].name = newName; updateDropdowns(); }
        function removePlayer(index) { players.splice(index, 1); renderSetupTable(); }

        function checkDrunkAndStart() {
            if(players.length<3) { alert("‡∏Ñ‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ!"); return; }
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            // SAVE ROLE SETUP TO STORAGE
            localStorage.setItem('werewolf_last_roles', JSON.stringify(players));

            if (players.some(p => p.role.includes("‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤") || p.role.includes("Drunk"))) {
                generateDrunkOptions(); new bootstrap.Modal(document.getElementById('drunkPoolModal')).show();
            } else { startGame(); }
        }

        // --- NEW: LOAD LAST GAME ---
        function loadLastGame() {
            const savedData = localStorage.getItem('werewolf_last_roles');
            if (!savedData) { alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß!"); return; }

            const savedPlayers = JSON.parse(savedData);
            players = savedPlayers.map(p => ({
                id: Date.now() + Math.random(),
                name: "", // Clear Name
                role: p.role,
                team: p.team,
                isAlive: true,
                loverId: null
            }));
            renderSetupTable();
        }
        // --- END NEW ---

        function generateDrunkOptions() {
            const container = document.getElementById('drunk-pool-selection'); container.innerHTML = '';
            roleDB.forEach(group => {
                group.roles.forEach(r => {
                    if (!r.name.includes("‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤")) {
                        container.innerHTML += `<div class="col-6 col-md-4"><div class="form-check"><input class="form-check-input drunk-pool-cb" type="checkbox" value="${r.name}" data-team="${r.team}" id="dp-${r.name}"><label class="form-check-label small" for="dp-${r.name}">${r.name}</label></div></div>`;
                    }
                });
            });
        }

        function saveDrunkPool() {
            const cbs = document.querySelectorAll('.drunk-pool-cb:checked');
            if (cbs.length === 0) { alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡πÉ‡∏ö!"); return; }
            drunkRolePool = []; cbs.forEach(cb => drunkRolePool.push({ name: cb.value, team: cb.dataset.team }));
            bootstrap.Modal.getInstance(document.getElementById('drunkPoolModal')).hide();
            startGame();
        }

        function startGame() {
            document.getElementById('setup-section').classList.add('d-none'); document.getElementById('game-section').classList.remove('d-none');
            startDayPhase(); log("=== ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏° (‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1) ===");
        }

        function toggleSound() {
            isMuted = !isMuted;
            const btn = document.getElementById('btn-mute');
            if (isMuted) { btn.innerHTML = 'üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡∏π‡πà'; btn.className = 'btn btn-secondary btn-sm'; }
            else { btn.innerHTML = 'üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡∏π‡πà'; btn.className = 'btn btn-outline-warning btn-sm'; }
        }

        function playAlarm() {
            if (isMuted) return;
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const duration = 5000;
            let nextNote = audioCtx.currentTime;
            for(let i=0; i<10; i++) {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.type = 'sine';
                osc.frequency.value = 880;
                osc.start(nextNote);
                osc.stop(nextNote + 0.2);
                gain.gain.setValueAtTime(0.1, nextNote);
                gain.gain.linearRampToValueAtTime(1, nextNote + 0.05);
                gain.gain.linearRampToValueAtTime(0.1, nextNote + 0.2);
                nextNote += 0.5;
            }
        }

        function startDayPhase() {
            document.getElementById('night-control-section').style.display = 'none';
            document.getElementById('vote-control-section').style.display = 'none';
            document.getElementById('day-timer-section').style.display = 'block';
            document.getElementById('phase-title').innerText = `‚òÄÔ∏è ‡πÄ‡∏ä‡πâ‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${dayCount}: ‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏ô‡∏ó‡∏ô‡∏≤`;

            if(dayCount===1){document.getElementById('timer-setup').style.display='block';document.getElementById('timer-quick-start').style.display='none';}
            else{document.getElementById('timer-setup').style.display='none';document.getElementById('timer-quick-start').style.display='block';document.getElementById('quick-time-label').innerText = `${savedTime.m}:${savedTime.s.toString().padStart(2,'0')}`;}
            document.getElementById('timer-controls').style.display = 'none';
            document.getElementById('timer-display').innerText = `${savedTime.m.toString().padStart(2,'0')}:${savedTime.s.toString().padStart(2,'0')}`;

            let toughDead = [];
            delayedDeaths.forEach((d, idx) => { if(d.turn===nightCount+1 && d.type==='tough') { let p=players.find(x=>x.id===d.id); if(p&&p.isAlive) toughDead.push(p); delete delayedDeaths[idx]; }});
            if(toughDead.length>0) { alert("‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ï‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏û‡∏¥‡∏©‡∏ö‡∏≤‡∏î‡πÅ‡∏ú‡∏•!"); handleDeaths(toughDead, "‡∏ó‡∏ô‡∏û‡∏¥‡∏©‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß", true); }
            if(dayCount === 3) processDrunkEvent();
            renderStatusTable(); checkWin();
        }

        function processDrunkEvent() {
            const drunks = players.filter(p => (p.role.includes("‡∏Ç‡∏µ‡πâ‡πÄ‡∏°‡∏≤") || p.role.includes("Drunk")) && p.isAlive);
            if (drunks.length === 0 || drunkRolePool.length === 0) return;
            let msg = "";
            drunks.forEach(p => {
                const newRoleObj = drunkRolePool[Math.floor(Math.random() * drunkRolePool.length)];
                p.role = newRoleObj.name; p.team = newRoleObj.team;
                msg += `- ${p.name} -> ${newRoleObj.name}\n`;
                log(`üç∫ ${p.name} ‡∏™‡∏£‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏≤ -> ${newRoleObj.name}`);
            });
            alert(`üç∫ ‡∏™‡∏£‡πà‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 3)!\n\n${msg}`);
            renderStatusTable();
        }

        function endDayGoNight() {
            clearInterval(timerInterval);
            document.getElementById('day-timer-section').style.display = 'none';
            document.getElementById('vote-control-section').style.display = 'none';
            document.getElementById('night-control-section').style.display = 'block';
            document.getElementById('timer-display').innerText = "00:00";
            updateNightBoxVisibility(); updateDropdowns();
            document.getElementById('night-count').innerText = nightCount;
        }

        function saveAndStartTimer() { const m=parseInt(document.getElementById('day-min').value)||0; const s=parseInt(document.getElementById('day-sec').value)||0; savedTime={m,s}; runTimer(m,s); document.getElementById('timer-setup').style.display='none'; }
        function quickStartTimer() { runTimer(savedTime.m, savedTime.s); document.getElementById('timer-quick-start').style.display='none'; }
        function showTimerEdit() { document.getElementById('timer-quick-start').style.display='none'; document.getElementById('timer-setup').style.display='block'; document.getElementById('day-min').value=savedTime.m; document.getElementById('day-sec').value=savedTime.s; }

        function runTimer(m,s) {
            timeLeft=(m*60)+s;
            document.getElementById('timer-controls').style.display='block';
            updateTimerDisplay();
            clearInterval(timerInterval);
            timerInterval=setInterval(()=>{
                timeLeft--;
                updateTimerDisplay();
                if(timeLeft<=0){
                    clearInterval(timerInterval);
                    playAlarm();
                    setTimeout(() => skipToVote(), 5000);
                }
            },1000);
        }
        function updateTimerDisplay() { let m=Math.floor(timeLeft/60); let s=timeLeft%60; document.getElementById('timer-display').innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`; }
        function pauseTimer() {
            if(timerInterval) { clearInterval(timerInterval); timerInterval=null; }
            else {
                timerInterval=setInterval(()=>{
                    timeLeft--;
                    updateTimerDisplay();
                    if(timeLeft<=0){
                        clearInterval(timerInterval);
                        playAlarm();
                        setTimeout(() => skipToVote(), 5000);
                    }
                },1000);
            }
        }

        function skipToVote() {
            clearInterval(timerInterval);
            document.getElementById('phase-title').innerText = "üó≥Ô∏è ‡∏ä‡πà‡∏ß‡∏á‡πÇ‡∏´‡∏ß‡∏ï (Vote Phase)";
            document.getElementById('timer-setup').style.display = 'none';
            document.getElementById('timer-quick-start').style.display = 'none';
            document.getElementById('timer-controls').style.display = 'none';
            document.getElementById('timer-display').className = 'timer-display timer-vote';
            if(pendingVampireVictims.length > 0) {
                let victims = []; pendingVampireVictims.forEach(id => { let p=players.find(x=>x.id===id); if(p&&p.isAlive) victims.push(p); });
                if(victims.length > 0) { alert("‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡∏ï‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!"); handleDeaths(victims, "‡∏û‡∏¥‡∏©‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå", true); }
                pendingVampireVictims = [];
            }
            timeLeft = 60; updateTimerDisplay();
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if(timeLeft <= 0) {
                    clearInterval(timerInterval);
                    playAlarm();
                    setTimeout(() => alert("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏´‡∏ß‡∏ï!"), 100);
                }
            }, 1000);
            updateDropdowns();

            document.getElementById('vote-select-phase').style.display = 'block';
            document.getElementById('vote-defense-phase').style.display = 'none';
            document.getElementById('vote-control-section').style.display = 'block';
        }

        function updateNightBoxVisibility() {
            const isAlive = (k) => players.some(p => p.isAlive && (p.role.includes(k) || p.team === k));
            document.querySelectorAll('.role-action-box').forEach(b => b.classList.remove('active'));

            const check = (keyword, boxId) => { if(players.some(p => p.isAlive && p.role.includes(keyword))) document.getElementById(boxId).classList.add('active'); };

            check('‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤','box-wolf'); check('Wolf','box-wolf'); check('‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå','box-vampire'); check('‡πÄ‡∏ó‡∏û‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ì‡πå','box-seer'); check('‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î','box-guard'); check('‡πÅ‡∏°‡πà‡∏°‡∏î','box-witch'); check('‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó','box-spellcaster'); check('‡πÅ‡∏°‡πà‡∏´‡∏°‡∏≠','box-oldhag'); check('‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä','box-priest'); check('‡πÄ‡∏à‡πâ‡∏≤‡∏•‡∏±‡∏ó‡∏ò‡∏¥','box-cult'); check('‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå','box-auraseer'); check('‡∏ô‡∏≤‡∏á‡∏õ‡∏µ‡∏®‡∏≤‡∏à','box-sorcerer'); check('‡∏ô‡∏±‡∏Å‡∏™‡∏∑‡∏ö','box-pi'); check('‡∏ú‡∏π‡πâ‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß‡∏ï‡∏ô','box-revealer'); check('‡∏ô‡∏±‡∏Å‡∏™‡∏∞‡∏Å‡∏î‡∏à‡∏¥‡∏ï','box-mentalist'); check('‡∏ú‡∏π‡πâ‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á','box-mystic'); check('‡∏û‡∏£‡∏≤‡∏ô‡∏´‡∏ç‡∏¥‡∏á','box-huntress');
            if(nightCount===1 && (isAlive('‡∏Å‡∏≤‡∏°‡πÄ‡∏ó‡∏û')||isAlive('Cupid'))) document.getElementById('box-cupid').classList.add('active');
        }

        function updateDropdowns() {
            const ids = ['wolf-target','wolf-target-2','guard-target','seer-target','vampire-target','revealer-target','vote-target','cupid-1','cupid-2','witch-save','witch-kill','hunter-target', 'spell-target', 'hag-target', 'priest-target', 'cult-target', 'aura-target', 'sorcerer-target', 'pi-target', 'mystic-target', 'huntress-target', 'mental-1', 'mental-2', 'bomber-L', 'bomber-R'];
            ids.forEach(id=>{
                const s=document.getElementById(id); if(!s)return;
                const f=s.options[0]; s.innerHTML=''; s.appendChild(f);
                players.forEach(p=>{ if(p.isAlive){ let o=document.createElement('option'); o.value=p.name; o.innerText=p.name; s.appendChild(o); }});
            });
            document.getElementById('wolf-rage-box').style.display = wolfRageMode ? 'block' : 'none';
            if(wolfDisabled) { document.getElementById('disease-alert').style.display='block'; document.getElementById('wolf-target').disabled=true; } else { document.getElementById('disease-alert').style.display='none'; document.getElementById('wolf-target').disabled=false; }
        }

        function processNight() {
            if(isGameOver) return;
            log(`\n--- ‡∏à‡∏ö‡∏Ñ‡∏∑‡∏ô‡∏ó‡∏µ‡πà ${nightCount} ---`);
            if(nightCount===1) { const c1=val('cupid-1'), c2=val('cupid-2'); if(c1&&c2&&c1!==c2){ let p1=get(c1),p2=get(c2); p1.loverId=p2.id; p2.loverId=p1.id; log(`üíò ‡∏Ñ‡∏π‡πà‡∏£‡∏±‡∏Å: ${p1.name} ‚ù§Ô∏è ${p2.name}`); } }
            const spell=val('spell-target'); if(spell) log(`ü§ê ${spell} ‡πÇ‡∏î‡∏ô‡πÉ‡∏ö‡πâ`);
            const hag=val('hag-target'); if(hag) log(`üëµ ${hag} ‡πÇ‡∏î‡∏ô‡πÑ‡∏•‡πà‡∏≠‡∏≠‡∏Å`);

            let deaths = [];
            const guardName=val('guard-target'), saveName=val('witch-save'), priestName=val('priest-target');
            let guardTarget=guardName?get(guardName):null;
            if(guardTarget) { if(guardTarget.id===lastGuardedId) { alert("‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏±‡∏ô‡∏ã‡πâ‡∏≥!"); guardTarget=null; } else lastGuardedId=guardTarget.id; }

            const w1=val('wolf-target'), w2=val('wolf-target-2');
            const attemptKill = (tName) => {
                if(!tName) return;
                let v = get(tName);
                if( (guardTarget && guardTarget.name===tName) || (saveName===tName) || (priestName===tName) ) { log(`üõ°Ô∏è ${tName} ‡∏£‡∏≠‡∏î`); }
                else {
                    if(v.role.includes("Vampire")||v.role.includes("‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå")) { log(`üõ°Ô∏è ‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏Å‡∏±‡∏î ${tName} ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤!`); }
                    else if(v.role.includes("‡∏Ñ‡∏≥‡∏™‡∏≤‡∏õ")) { v.team="wolf"; v.role+="(‡∏´‡∏°‡∏≤)"; log(`üê∫ ${tName} ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤!`); }
                    else if(v.role.includes("‡∏ñ‡∏∂‡∏Å")) { log(`üí™ ${tName} ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö`); delayedDeaths.push({id:v.id, turn: nightCount+1, type:'tough'}); }
                    else if(v.role.includes("‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠")) { log(`ü§¢ ‡∏Å‡∏¥‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡πÄ‡∏ä‡∏∑‡πâ‡∏≠!`); wolfDisabled=true; deaths.push(v); }
                    else { deaths.push(v); }
                }
            };
            if(!wolfDisabled) { attemptKill(w1); if(wolfRageMode && w2) { log("üî• ‡∏Ü‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°!"); attemptKill(w2); wolfRageMode=false; } } else wolfDisabled=false;

            const vamp=val('vampire-target');
            if(vamp) {
                if((guardTarget&&guardTarget.name===vamp)||(saveName===vamp)||(priestName===vamp)) { log(`üõ°Ô∏è ${vamp} ‡∏£‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå`); }
                else { log(`üßõ‚Äç‚ôÇÔ∏è ‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡∏Å‡∏±‡∏î ${vamp}`); pendingVampireVictims.push(get(vamp).id); }
            }

            const poison=val('witch-kill'); if(poison) { log(`üß™ ‡πÅ‡∏°‡πà‡∏°‡∏î‡∏Ü‡πà‡∏≤ ${poison}`); deaths.push(get(poison)); }
            const hunt=val('huntress-target'); if(hunt) { log(`üèπ ‡∏û‡∏£‡∏≤‡∏ô‡∏´‡∏ç‡∏¥‡∏á‡∏¢‡∏¥‡∏á ${hunt}`); deaths.push(get(hunt)); }
            const rev=val('revealer-target'); if(rev) { let t=get(rev); if(t.team==='wolf'||t.role.includes('Werewolf')) { log(`üî¶ ‡∏ä‡∏µ‡πâ‡∏ñ‡∏π‡∏Å! ${t.name} ‡∏ï‡∏≤‡∏¢`); deaths.push(t); } else { log(`üî¶ ‡∏ä‡∏µ‡πâ‡∏ú‡∏¥‡∏î! ‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ï‡∏≤‡∏¢`); let me=players.find(p=>p.role.includes("‡πÄ‡∏ú‡∏¢")); if(me&&me.isAlive) deaths.push(me); } }

            const aura = val('aura-target');
            if (aura) {
                let p = get(aura);
                let isNormal = (p.role.includes("‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô (Villager)") || p.role.includes("‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤ (Werewolf)"));
                if (isNormal) { log(`‚ú® ‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå‡∏™‡πà‡∏≠‡∏á ${p.name} -> ‚ö™ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô`); }
                else { let isBad = (p.team !== 'villager'); log(`‚ú® ‡∏ç‡∏≤‡∏ì‡∏ó‡∏¥‡∏û‡∏¢‡πå‡∏™‡πà‡∏≠‡∏á ${p.name} -> ${isBad ? 'üî¥ BAD (‡∏Ñ‡∏ô‡πÄ‡∏•‡∏ß)' : 'üü¢ GOOD (‡∏Ñ‡∏ô‡∏î‡∏µ)'}`); }
            }

            const seer=val('seer-target'); if(seer){ let p=get(seer); let isEvil=(p.team==='wolf'||p.team==='vampire'||p.role.includes('Lycan')||p.role.includes('‡∏Ü‡∏≤‡∏ï‡∏Å‡∏£')); log(`üîÆ ‡πÄ‡∏ó‡∏û‡∏Ø‡∏™‡πà‡∏≠‡∏á ${p.name} -> ${isEvil?'üî¥ ‡πÄ‡∏•‡∏ß':'üü¢ ‡∏î‡∏µ'}`); }
            const mystic=val('mystic-target'); if(mystic){ let p=get(mystic); log(`üëÅÔ∏è‚Äçüó®Ô∏è ‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏™‡πà‡∏≠‡∏á ${p.name} -> "${p.role}"`); }

            handleDeaths(deaths, "‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô", true);
            document.querySelectorAll('select').forEach(s=>s.selectedIndex=0);
            nightCount++; dayCount++; startDayPhase();
        }

        let defenseTimer = null;

        function startDefense() {
            const targetName = val('vote-target');
            if (!targetName) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡πÄ‡∏•‡∏¢‡∏Å‡πà‡∏≠‡∏ô!"); return; }

            currentDefendant = get(targetName);
            document.getElementById('vote-select-phase').style.display = 'none';
            document.getElementById('vote-defense-phase').style.display = 'block';
            document.getElementById('defendant-name').innerText = `‡∏à‡∏≥‡πÄ‡∏•‡∏¢: ${currentDefendant.name}`;

            let timeLeftDefense = 30;
            const timerEl = document.getElementById('defense-timer');
            timerEl.innerText = timeLeftDefense;

            clearInterval(defenseTimer);
            defenseTimer = setInterval(() => {
                timeLeftDefense--;
                timerEl.innerText = timeLeftDefense;
                if (timeLeftDefense <= 0) clearInterval(defenseTimer);
            }, 1000);
        }

        function finalizeVerdict(isGuilty) {
            clearInterval(defenseTimer);

            if (isGuilty) {
                log(`‚öñÔ∏è ‡∏®‡∏≤‡∏•‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô: ‡∏õ‡∏£‡∏∞‡∏´‡∏≤‡∏£ ${currentDefendant.name} (Guilty)`);
                if(currentDefendant.role.includes("‡∏¢‡∏≤‡∏à‡∏Å")){ win(`${currentDefendant.name} (‡∏¢‡∏≤‡∏à‡∏Å) ‡∏ä‡∏ô‡∏∞!`,"bg-warning","‡∏ï‡∏≤‡∏¢‡∏™‡∏°‡πÉ‡∏à"); handleDeaths([currentDefendant],"‡πÇ‡∏´‡∏ß‡∏ï",false); return; }
                if(currentDefendant.role.includes("‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡∏≤‡∏¢")){ alert("‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡∏≤‡∏¢‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß! ‡∏£‡∏≠‡∏î"); log(`üëë ${currentDefendant.name} ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏ä‡∏≤‡∏¢ (‡∏£‡∏≠‡∏î)`); endDayGoNight(); return; }
                if(currentDefendant.role.includes("‡πÑ‡∏≠‡πâ‡∏ó‡∏∂‡πà‡∏°")){ alert("‡πÑ‡∏≠‡πâ‡∏ó‡∏∂‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏ï‡∏±‡∏ß! ‡∏£‡∏≠‡∏î"); log(`ü§™ ${currentDefendant.name} ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πâ‡∏ó‡∏∂‡πà‡∏° (‡∏£‡∏≠‡∏î)`); endDayGoNight(); return; }
                pendingVampireVictims = pendingVampireVictims.filter(id => id !== currentDefendant.id);
                handleDeaths([currentDefendant], "‡πÇ‡∏´‡∏ß‡∏ï", false);
                updateDropdowns(); renderStatusTable(); checkWin();
            } else {
                log(`‚öñÔ∏è ‡∏®‡∏≤‡∏•‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô: ‡∏¢‡∏Å‡∏ü‡πâ‡∏≠‡∏á ${currentDefendant.name} (Innocent)`);
            }
            endDayGoNight();
        }

        function handleDeaths(list, cause, triggerHunter) {
            let deadSet = new Set(list);
            deadSet.forEach(p=>{
                if(!p.isAlive) return;
                p.isAlive=false; log(`üíÄ ${p.name} ‡∏ï‡∏≤‡∏¢ (${cause})`);
                if(p.role.includes("‡∏•‡∏π‡∏Å‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤") || p.role.includes("Wolf Cub")) { alert(`üê∫ü©∏ ‡∏•‡∏π‡∏Å‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏ï‡∏≤‡∏¢!! ‡∏Ñ‡∏∑‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Ü‡πà‡∏≤ 2`); log("‚ö†Ô∏è Wolf Rage Mode ON"); wolfRageMode=true; }
                if(p.role.includes("‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î")) { document.getElementById('mad-bomber-section').style.display='block'; alert("‡∏°‡∏∑‡∏≠‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏ï‡∏≤‡∏¢!"); }
                if(p.loverId){ let l=players.find(x=>x.id===p.loverId); if(l&&l.isAlive){ l.isAlive=false; log(`üíî ${l.name} ‡∏ï‡∏£‡∏≠‡∏°‡πÉ‡∏à`); if(triggerHunter) checkHunter(l); }}
                if(triggerHunter) checkHunter(p);
            });
        }

        function checkHunter(p) { if(p.role.includes("‡∏û‡∏£‡∏≤‡∏ô")||p.role.includes("Hunter")){ document.getElementById('hunter-revenge-section').style.display='block'; alert(`‡∏ô‡∏≤‡∏¢‡∏û‡∏£‡∏≤‡∏ô‡∏ï‡∏≤‡∏¢! ‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏¢‡∏¥‡∏á‡πÉ‡∏Ñ‡∏£?`); updateDropdowns(); } }
        function hunterShoot(){ const t=val('hunter-target'); if(!t)return; if(confirm(`‡∏¢‡∏¥‡∏á ${t}?`)){ log(`üí• ‡∏ô‡∏≤‡∏¢‡∏û‡∏£‡∏≤‡∏ô‡∏¢‡∏¥‡∏á ${t}`); handleDeaths([get(t)],"‡πÇ‡∏î‡∏ô‡∏¢‡∏¥‡∏á",false); document.getElementById('hunter-revenge-section').style.display='none'; updateDropdowns(); renderStatusTable(); checkWin(); } }
        function bomberExplode() { const l=val('bomber-L'), r=val('bomber-R'); if(confirm(`‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î ${l} ‡πÅ‡∏•‡∏∞ ${r}?`)) { let d=[]; if(l)d.push(get(l)); if(r)d.push(get(r)); log(`üí£ ‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!`); handleDeaths(d, "‡πÇ‡∏î‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î", false); document.getElementById('mad-bomber-section').style.display='none'; updateDropdowns(); renderStatusTable(); checkWin(); } }

        function get(n){ return players.find(p=>p.name===n); }
        function val(id){ return document.getElementById(id).value; }
        function checkWin(){
            const w=players.filter(p=>p.isAlive&&p.team==='wolf').length;
            const v=players.filter(p=>p.isAlive&&p.team==='vampire').length;
            const g=players.filter(p=>p.isAlive&&p.team==='villager').length;
            const solo=players.filter(p=>p.isAlive&&p.team==='solo').length;
            if(v>0 && v>=(w+g+solo)) win("üßõ‚Äç‚ôÇÔ∏è ‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡∏ä‡∏ô‡∏∞!","bg-danger","‡πÅ‡∏ß‡∏°‡πÑ‡∏û‡∏£‡πå‡∏Ñ‡∏£‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á");
            else if(w===0 && v===0 && solo===0) win("üéâ ‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡∏ä‡∏ô‡∏∞!","bg-success","‡∏Ñ‡∏ô‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏≤‡∏¢‡∏´‡∏°‡∏î");
            else if(w>=(g+v+solo)) win("üê∫ ‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏ä‡∏ô‡∏∞!","bg-danger","‡∏´‡∏°‡∏≤‡∏õ‡πà‡∏≤‡∏Ñ‡∏£‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á");
        }
        function win(t,c,d){ isGameOver=true; const b=document.getElementById('winner-banner'); b.innerHTML=`${t}<br><small>${d}</small><br><button onclick='location.reload()' class='btn btn-light mt-2'>‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>`; b.className=`game-over-alert text-white ${c}`; b.style.display='block'; }
        function renderStatusTable(){ document.getElementById('status-table-body').innerHTML = players.map(p=>{ let badges=p.loverId?" ‚ù§Ô∏è":""; if(p.role.includes("‡∏ñ‡∏∂‡∏Å")&&delayedDeaths.some(d=>d.id===p.id))badges+=" ü©∏"; return `<tr class="${p.isAlive?'':'dead-row'}"><td>${p.name}${badges}</td><td>${p.role}</td><td class="${p.isAlive?'st-alive':'st-dead'}">${p.isAlive?'Alive':'Dead'}</td></tr>`; }).join(''); }
        function log(m){ const b=document.getElementById('game-log'); b.innerHTML+=`<div>${m}</div>`; b.scrollTop=b.scrollHeight; }
    </script>
</body>
</html>